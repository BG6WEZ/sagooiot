import{L as P,a2 as W,k as q,o as _,a as g,U as F,V as B,b as t,M as O,X as $,O as R,P as te,h as y,i as oe,ab as ae,_ as o,T as a,ai as n,as as se,S as E,Z as r,a1 as ne,F as le,a8 as ie,Y as N,aB as de,aC as re}from"./vue.1701184304695.js";import ue from"./edit.17011843046957.js";import{a as b}from"./index.170118430469519.js";import{_ as G,G as ce,H as pe,I as _e,v as me,F as he,t as fe,J as De,E as T,h as ve}from"./index.1701184304695.js";const be={class:"slot-box"},Fe={class:"iconfont icon-zhankai-"},Be={class:"iconfont icon-zhankai"},ye={class:"column-right"},Ee=P({__name:"index",props:{cls:{type:String,default:"column"},width:{type:String,default:"200px"},collapsable:{type:Boolean,default:!0},showSideTree:{type:Boolean,default:!0}},setup(e){const i=e,s=W({isOpen:!0,realWidth:""});q(()=>{s.realWidth=i.width});const p=()=>{s.realWidth=s.isOpen?"0px":i.width,setTimeout(()=>{s.isOpen=!s.isOpen},100)};return(h,w)=>(_(),g("div",{class:R(e.cls)},[F(t("div",{class:R(["column-left",{close:!s.isOpen}]),style:te({width:s.realWidth})},[F(t("div",be,[O(h.$slots,"left",{},void 0,!0)],512),[[B,s.isOpen]]),e.collapsable?(_(),g("div",{key:0,class:"toggle-arrow",onClick:p},[F(t("i",Fe," < ",512),[[B,!s.isOpen]]),F(t("i",Be," > ",512),[[B,s.isOpen]])])):$("",!0)],6),[[B,e.showSideTree]]),t("div",ye,[O(h.$slots,"right",{},void 0,!0)])],2))}});var ge=G(Ee,[["__scopeId","data-v-678447ef"]]);const we=P({name:"deviceTree",components:{AddOrUpdate:ue,LrLayout:ge,Fold:ce,Expand:pe,More:_e,Plus:me,Edit:he,Delete:fe,Search:De},setup(){const e=y(),i=y(),s=W({ids:[],tableData:{data:[],total:0,loading:!1,param:{pageNum:1,pageSize:10,status:"",name:""}},treeData:[],treeLoading:!1,tabName:"1",searchVal:"",treeDetail:{},deviceList:[],unitData:[{label:"\u79D2",value:1},{label:"\u5206",value:2},{label:"\u65F6",value:3},{label:"\u5929",value:4}]});let p=y({startDate:"",endDate:"",deviceKey:""}),h=y();oe(()=>s.searchVal,l=>{h.value.filter(l)});const w=(l,c)=>l?c.name.includes(l):!0,C=()=>{m(),k()},m=()=>{s.treeLoading=!0,b.tree.getList({}).then(l=>{s.treeData=l.list}).finally(()=>s.treeLoading=!1)},k=()=>{b.device.allList({}).then(l=>{s.deviceList=l.device||[]})},f=()=>{};q(()=>{C()});const V=l=>{!l||l.resetFields()},D=l=>{s.ids=l.map(c=>c.id)},S=l=>{b.tree.detail({infoId:l.infoId}).then(c=>{s.treeDetail=c.data||{},p.value.startDate=s.treeDetail.startDate,p.value.endDate=s.treeDetail.endDate,p.value.deviceKey=s.treeDetail.deviceKey})},L=()=>{if(!s.treeDetail.id){T.warning("\u8BF7\u9009\u62E9\u8282\u70B9\u6811");return}b.tree.edit({...s.treeDetail,endDate:p.value.endDate,startDate:p.value.startDate,deviceKey:p.value.deviceKey}).then(()=>{T.success("\u4FEE\u6539\u6210\u529F")})};return{addOrUpdateRef:e,queryRef:i,zlTreeSearchRef:h,typeList:f,resetQuery:V,handleSelectionChange:D,operateCmd:(l,c)=>{switch(l){case"add":e.value.openDialog(l,c);break;case"edit":e.value.openDialog(l,c);break;case"delete":ve.confirm("\u662F\u5426\u5220\u9664\u8BE5\u8BBE\u5907\u6811","\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{b.tree.delete({id:c.infoId}).then(()=>{T.success("\u5220\u9664\u6210\u529F"),m()})}).catch(()=>{});break}},getTreeList:m,nodeClick:S,...ae(s),ruleForm:p,onSaveTime:L,filterNode:w}}}),u=e=>(de("data-v-5c11b5f3"),e=e(),re(),e),Ce={class:"system-dic-container"},ke=N("\u65B0\u5EFA\u8282\u70B9"),Ve={class:"custom-tree-node"},Se={class:"tree-label"},Le={class:"ant-descriptions-row"},Ae=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u540D\u79F0",-1)),Te={class:"ant-descriptions-item-content",colspan:"1"},Oe=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u5730\u5740",-1)),$e={class:"ant-descriptions-item-content",colspan:"1"},Ne=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u7ECF\u5EA6",-1)),ze={class:"ant-descriptions-item-content",colspan:"1"},Ue={class:"ant-descriptions-row"},Ie=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u7EAC\u5EA6",-1)),Ke={class:"ant-descriptions-item-content",colspan:"1"},Me=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u8054\u7CFB\u4EBA",-1)),Re={class:"ant-descriptions-item-content",colspan:"1"},Pe=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u8054\u7CFB\u7535\u8BDD",-1)),We={class:"ant-descriptions-item-content",colspan:"1"},qe={class:"ant-descriptions-row"},Ge=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u670D\u52A1\u5468\u671F\uFF1A\u5F00\u59CB\u65E5\u671F",-1)),He={class:"ant-descriptions-item-content",colspan:"1"},Je=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u670D\u52A1\u5468\u671F\uFF1A\u622A\u6B62\u65E5\u671F",-1)),Qe={class:"ant-descriptions-item-content",colspan:"1"},Xe=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u56FE\u7247",-1)),Ye={class:"ant-descriptions-item-content",colspan:"1"},Ze={class:"ant-descriptions-row"},je=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u8BBE\u5907\u6807\u8BC6",-1)),xe={class:"ant-descriptions-item-content",colspan:"1"},et=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u8BBE\u5907\u6240\u5C5E\u533A\u57DF",-1)),tt={class:"ant-descriptions-item-content",colspan:"1"},ot=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u6240\u5C5E\u516C\u53F8",-1)),at={class:"ant-descriptions-item-content",colspan:"1"},st={class:"ant-descriptions-row"},nt=u(()=>t("th",{class:"ant-descriptions-item-label ant-descriptions-item-colon"},"\u7C7B\u578B",-1)),lt={class:"ant-descriptions-item-content",colspan:"5"},it=N("\u4FDD\u5B58"),dt={style:{float:"left"}},rt=N("\u4FDD\u5B58");function ut(e,i,s,p,h,w){const C=n("el-input"),m=n("el-button"),k=n("More"),f=n("el-icon"),V=n("Plus"),D=n("el-dropdown-item"),S=n("Edit"),L=n("Delete"),z=n("el-dropdown-menu"),l=n("el-dropdown"),c=n("el-tree"),H=n("el-scrollbar"),U=n("el-card"),I=n("el-col"),A=n("el-tab-pane"),K=n("el-date-picker"),v=n("el-form-item"),J=n("el-form"),Q=n("el-option"),X=n("el-select"),Y=n("el-tabs"),Z=n("el-row"),j=n("AddOrUpdate"),x=se("loading");return _(),g("div",Ce,[o(Z,{gutter:10},{default:a(()=>[o(I,{span:5},{default:a(()=>[o(U,{shadow:"hover"},{default:a(()=>[F((_(),E(H,null,{default:a(()=>[o(C,{"prefix-icon":e.search,modelValue:e.searchVal,"onUpdate:modelValue":i[0]||(i[0]=d=>e.searchVal=d),placeholder:"\u8BF7\u8F93\u5165\u8BBE\u5907\u6811\u540D\u79F0",clearable:"",size:"default",style:{width:"100%"}},null,8,["prefix-icon","modelValue"]),!e.treeLoading&&!e.treeData.length?(_(),E(m,{key:0,type:"primary",class:"mt-2",onClick:i[1]||(i[1]=d=>e.operateCmd("add",{})),style:{width:"100%"}},{default:a(()=>[ke]),_:1})):$("",!0),e.treeLoading?$("",!0):(_(),E(c,{key:1,ref:"zlTreeSearchRef",data:e.treeData,props:{children:"children",label:"name"},"filter-node-method":e.filterNode,"default-expand-all":!0,"node-key":"id","highlight-current":"",onNodeClick:e.nodeClick},{default:a(({node:d,data:M})=>[t("div",Ve,[t("span",Se,r(d.label),1),t("span",{class:"tree-options",onClick:i[2]||(i[2]=ne(()=>{},["stop"]))},[O(e.$slots,"operate",{data:M},()=>[o(l,{onCommand:ee=>e.operateCmd(ee,M)},{dropdown:a(()=>[o(z,null,{default:a(()=>[o(D,{command:"add"},{default:a(()=>[o(f,null,{default:a(()=>[o(V)]),_:1})]),_:1}),o(D,{command:"edit"},{default:a(()=>[o(f,null,{default:a(()=>[o(S)]),_:1})]),_:1}),o(D,{command:"delete"},{default:a(()=>[o(f,null,{default:a(()=>[o(L)]),_:1})]),_:1})]),_:1})]),default:a(()=>[o(f,null,{default:a(()=>[o(k)]),_:1})]),_:2},1032,["onCommand"])],!0)])])]),_:3},8,["data","filter-node-method","onNodeClick"]))]),_:3})),[[x,e.treeLoading]])]),_:3})]),_:3}),o(I,{span:19},{default:a(()=>[o(U,{shadow:"hover"},{default:a(()=>[o(Y,{modelValue:e.tabName,"onUpdate:modelValue":i[6]||(i[6]=d=>e.tabName=d)},{default:a(()=>[o(A,{label:"\u8BBE\u5907\u6811\u4FE1\u606F",name:"1"},{default:a(()=>[t("table",null,[t("tbody",null,[t("tr",Le,[Ae,t("td",Te,r(e.treeDetail.name),1),Oe,t("td",$e,r(e.treeDetail.address),1),Ne,t("td",ze,r(e.treeDetail.lng),1)]),t("tr",Ue,[Ie,t("td",Ke,r(e.treeDetail.lat),1),Me,t("td",Re,r(e.treeDetail.contact),1),Pe,t("td",We,r(e.treeDetail.phone),1)]),t("tr",qe,[Ge,t("td",He,r(e.treeDetail.startDate),1),Je,t("td",Qe,r(e.treeDetail.endDate),1),Xe,t("td",Ye,r(e.treeDetail.image),1)]),t("tr",Ze,[je,t("td",xe,r(e.treeDetail.deviceKey),1),et,t("td",tt,r(e.treeDetail.area),1),ot,t("td",at,r(e.treeDetail.company),1)]),t("tr",st,[nt,t("td",lt,r(e.treeDetail.types),1)])])])]),_:1}),o(A,{label:"\u65F6\u95F4\u5468\u671F",name:"2"},{default:a(()=>[o(J,{model:e.ruleForm,ref:"formRef",size:"default","label-width":"80px"},{default:a(()=>[o(v,{label:"\u5F00\u59CB\u65E5\u671F",prop:"startDate"},{default:a(()=>[o(K,{modelValue:e.ruleForm.startDate,"onUpdate:modelValue":i[3]||(i[3]=d=>e.ruleForm.startDate=d),type:"date",placeholder:"\u9009\u62E9\u5F00\u59CB\u65E5\u671F",class:"w-35",size:"default"},null,8,["modelValue"])]),_:1}),o(v,{label:"\u7ED3\u675F\u65E5\u671F",prop:"endDate"},{default:a(()=>[o(K,{modelValue:e.ruleForm.endDate,"onUpdate:modelValue":i[4]||(i[4]=d=>e.ruleForm.endDate=d),type:"date",placeholder:"\u9009\u62E9\u7ED3\u675F\u65E5\u671F",class:"w-35",size:"default"},null,8,["modelValue"])]),_:1}),o(v,{label:" ",prop:"category"},{default:a(()=>[o(m,{type:"primary",onClick:e.onSaveTime},{default:a(()=>[it]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),o(A,{label:"\u7ED1\u5B9A\u5B9E\u9645\u8BBE\u5907",name:"3"},{default:a(()=>[o(v,{label:"\u9009\u62E9\u8BBE\u5907",prop:"deviceKey"},{default:a(()=>[o(X,{modelValue:e.ruleForm.deviceKey,"onUpdate:modelValue":i[5]||(i[5]=d=>e.ruleForm.deviceKey=d),filterable:"",placeholder:"\u8BF7\u9009\u62E9\u8BBE\u5907"},{default:a(()=>[(_(!0),g(le,null,ie(e.deviceList,d=>(_(),E(Q,{key:d.key,label:d.name,value:d.key},{default:a(()=>[t("span",dt,r(d.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(v,{label:" ",prop:"category"},{default:a(()=>[o(m,{type:"primary",onClick:e.onSaveTime},{default:a(()=>[rt]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:3}),o(j,{ref:"addOrUpdateRef",onFinish:e.getTreeList},null,8,["onFinish"])])}var ht=G(we,[["render",ut],["__scopeId","data-v-5c11b5f3"]]);export{ht as default};
