import{a as E}from"./index.17011843046957.js";/* empty css                    */import{v as z}from"./vue3cron.1701184304695.js";import{_ as J,t as O,v as H,w as M,x as G,y as W,E as B}from"./index.1701184304695.js";import{L as X,h as K,a2 as Y,ab as Z,a as F,_ as l,T as t,e as Q,ai as f,o as p,b as c,S as P,X as A,Y as i,Z as N,F as D,a8 as _}from"./vue.1701184304695.js";const x=X({name:"Edit",components:{Delete:O,Plus:H,CircleClose:M,Minus:G,Right:W,vue3cron:z},setup(e,{emit:a}){const I=K(null),S=K(null),u=Y({isShowDialog:!1,dialogVisible:!1,cronShow:!1,crontype:"",config:{},devconfig:{},tabconfig:{},sourceData:[],sourceId:0,jsonData:"",ruledata:[{expression:"",replace:""}],rule:[{expression:"",replace:""}],requestParams:[[{type:"",key:"",name:"",value:""}]],methodData:[{label:"GET",value:"get"},{label:"POST",value:"post"}],unitData:[{label:"\u79D2",value:"second"},{label:"\u5206",value:"minute"},{label:"\u65F6",value:"hour"},{label:"\u5929",value:"day"}],paramData:[{lable:"header",value:"header"},{lable:"body",value:"body"},{lable:"param",value:"param"}],ruleForm:{sourceId:0,name:"",from:1,key:"",rule:[],config:{method:"",url:"",interval:"",intervalUnit:"",requestParams:[]},desc:""},rules:{key:[{required:!0,message:"\u6570\u636E\u6E90\u6807\u8BC6\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{required:!0,message:"\u6570\u636E\u6E90\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],from:[{required:!0,message:"\u6570\u636E\u6E90\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),T=n=>{u.requestParams.splice(n,1)},r=(n,s)=>{u.requestParams[n].splice(s,1)},d=()=>{u.requestParams.push([{type:"",key:"",name:"",value:""}]),console.log(u.requestParams)},y=n=>{u.requestParams[n].push({type:"",key:"",name:"",value:""})},V=n=>{u.rule.splice(n,1)},k=()=>{u.rule.push({expression:"",replace:""})},v=n=>{g(),q(),console.log(u.requestParams),n&&(u.sourceId=n.sourceId,E.common.detail(n.sourceId).then(s=>{u.ruleForm=s.data,s.data.from==1?(u.config=s.data.apiConfig,u.requestParams=s.data.apiConfig.requestParams):s.data.from==4?u.devconfig=s.data.deviceConfig:s.data.from==2&&(u.tabconfig=s.data.dbConfig),s.data.sourceRule.forEach((m,j)=>{u.rule[j].expression=m.expression,u.rule[j].replace=m.replace})})),u.isShowDialog=!0},C=n=>{if(n.target.innerText&&n.target.className=="jv-key"){let s=n.target.innerText;s=s.substr(0,s.length-1),console.log(s)}},g=()=>{u.devconfig={},u.tabconfig={},u.ruleForm={sourceId:0,name:"",from:1,key:"",rule:[],config:{method:"",url:"",interval:"",intervalUnit:"",requestParams:[]},desc:""}},b=()=>{u.isShowDialog=!1},U=()=>{b()},q=()=>{E.common.getdevList({}).then(n=>{u.sourceData=n.device})};return{cronclose:()=>{u.cronShow=!1},showCron:n=>{u.crontype=n,u.cronShow=!0},onTest:()=>{u.ruleForm.from==1?E.common.api(u.sourceId).then(n=>{u.jsonData=JSON.parse(n.data),u.dialogVisible=!0,console.log(n)}):u.ruleForm.from==4&&E.common.devapi(u.sourceId).then(n=>{u.jsonData=JSON.parse(n.data),u.dialogVisible=!0,console.log(n)})},addRule:k,delRule:V,handlelisten:n=>{console.log(n),n.type=="config"?u.config.cronExpression=n.cron:n.type=="tabconfig"&&(u.tabconfig.cronExpression=n.cron)},addParams:y,addParamss:d,delParamss:r,delParams:T,onKeyclick:C,openDialog:v,setNode:n=>{u.sourceData.forEach((s,m)=>{s.id==n&&(u.devconfig.productKey=s.product.key,u.devconfig.deviceKey=s.key)})},closeDialog:b,getDevData:q,onCancel:U,onSubmit:()=>{const n=Q(S);console.log(n),n&&n.validate(s=>{s&&(u.ruleForm.rule=u.rule,u.ruleForm.from==1?(u.config.requestParams=u.requestParams,u.ruleForm.config=u.config):u.ruleForm.from==4?u.ruleForm.config=u.devconfig:u.ruleForm.from==2&&(u.ruleForm.config=u.tabconfig),u.ruleForm.sourceId!==0?u.ruleForm.from==1?E.common.edit(u.ruleForm).then(()=>{B.success("\u6570\u636E\u6E90\u7C7B\u578B\u4FEE\u6539\u6210\u529F"),b(),a("typeList")}):u.ruleForm.from==4?E.common.devedit(u.ruleForm).then(()=>{B.success("\u6570\u636E\u6E90\u7C7B\u578B\u4FEE\u6539\u6210\u529F"),b(),a("typeList")}):u.ruleForm.from==2&&E.common.dbedit(u.ruleForm).then(()=>{B.success("\u6570\u636E\u6E90\u7C7B\u578B\u4FEE\u6539\u6210\u529F"),b(),a("typeList")}):u.ruleForm.from==1?E.common.add(u.ruleForm).then(()=>{B.success("\u6570\u636E\u6E90\u7C7B\u578B\u6DFB\u52A0\u6210\u529F"),b(),a("typeList")}):u.ruleForm.from==4?E.common.devadd(u.ruleForm).then(()=>{B.success("\u6570\u636E\u6E90\u7C7B\u578B\u6DFB\u52A0\u6210\u529F"),b(),a("typeList")}):u.ruleForm.from==2&&E.common.dbadd(u.ruleForm).then(()=>{B.success("\u6570\u636E\u6E90\u7C7B\u578B\u6DFB\u52A0\u6210\u529F"),b(),a("typeList")}))})},formRef:S,myRef:I,...Z(u)}}}),ee={class:"system-edit-dic-container"},le=i("api\u5BFC\u5165"),ue=i("\u8BBE\u5907"),oe=i("\u6570\u636E\u5E93"),ae=i("\u6570\u636E\u6E90\u914D\u7F6E"),te={key:0},ne={style:{display:"flex"}},se=i("\u8BBE\u7F6E"),de={class:"box-content"},re={class:"conicon",style:{width:"100%","text-align":"right",position:"absolute",right:"-8px",top:"-8px",color:"red"}},ie={style:{display:"flex"}},me=i("\u8BF7\u6C42\u53C2\u6570"),fe={class:"conicon"},pe=i("\u589E\u52A0"),ce=c("div",{style:{}},null,-1),Fe=i("\u589E\u52A0\u5206\u7EC4"),ge={key:1},be={style:{float:"left"}},Ee={style:{float:"right","font-size":"13px"}},ye={key:2},Be=i("mysql"),Ve=i("mssql"),ve={class:"inline"},Ce={class:"inline"},he=i("\u6570\u636E\u8868"),De=i("Sql"),_e={style:{display:"flex"}},ke=i("\u8BBE\u7F6E"),Ue={class:"dialog-footer"},qe=i("\u6D4B\u8BD5"),we=i("\u53D6 \u6D88"),Pe={class:"dialog-footer"},Ae=i("\u5173\u95ED");function Se(e,a,I,S,u,T){const r=f("el-input"),d=f("el-form-item"),y=f("el-radio"),V=f("el-radio-group"),k=f("el-divider"),v=f("el-option"),C=f("el-select"),g=f("el-button"),b=f("CircleClose"),U=f("el-icon"),q=f("Delete"),$=f("el-form"),w=f("el-dialog"),L=f("JsonViewer"),R=f("vue3cron");return p(),F("div",ee,[l(w,{title:(e.ruleForm.sourceId!==0?"\u4FEE\u6539":"\u6DFB\u52A0")+"\u6570\u636E\u6E90",modelValue:e.isShowDialog,"onUpdate:modelValue":a[21]||(a[21]=o=>e.isShowDialog=o),width:"769px"},{footer:t(()=>[c("span",Ue,[e.ruleForm.sourceId>0?(p(),P(g,{key:0,onClick:e.onTest,type:"warning",size:"default"},{default:t(()=>[qe]),_:1},8,["onClick"])):A("",!0),l(g,{onClick:e.onCancel,size:"default"},{default:t(()=>[we]),_:1},8,["onClick"]),l(g,{type:"primary",onClick:e.onSubmit,size:"default"},{default:t(()=>[i(N(e.ruleForm.sourceId!==0?"\u4FEE \u6539":"\u6DFB \u52A0"),1)]),_:1},8,["onClick"])])]),default:t(()=>[l($,{model:e.ruleForm,ref:"formRef",rules:e.rules,size:"default","label-width":"110px"},{default:t(()=>[l(d,{label:"\u6570\u636E\u6E90\u6807\u8BC6",prop:"key"},{default:t(()=>[l(r,{modelValue:e.ruleForm.key,"onUpdate:modelValue":a[0]||(a[0]=o=>e.ruleForm.key=o),placeholder:"\u8BF7\u8F93\u5165\u6570\u636E\u6E90\u540D\u79F0",disabled:e.ruleForm.sourceId},null,8,["modelValue","disabled"])]),_:1}),l(d,{label:"\u6570\u636E\u6E90\u540D\u79F0",prop:"name"},{default:t(()=>[l(r,{modelValue:e.ruleForm.name,"onUpdate:modelValue":a[1]||(a[1]=o=>e.ruleForm.name=o),placeholder:"\u8BF7\u8F93\u5165\u6570\u636E\u6E90\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u63CF\u8FF0",prop:"desc"},{default:t(()=>[l(r,{modelValue:e.ruleForm.desc,"onUpdate:modelValue":a[2]||(a[2]=o=>e.ruleForm.desc=o),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u6570\u636E\u6765\u6E90",prop:"from"},{default:t(()=>[l(V,{modelValue:e.ruleForm.from,"onUpdate:modelValue":a[3]||(a[3]=o=>e.ruleForm.from=o)},{default:t(()=>[l(y,{label:1},{default:t(()=>[le]),_:1}),l(y,{label:4},{default:t(()=>[ue]),_:1}),l(y,{label:2},{default:t(()=>[oe]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(k,{"content-position":"left"},{default:t(()=>[ae]),_:1}),e.ruleForm.from==1?(p(),F("div",te,[l(d,{label:"\u8BF7\u6C42\u65B9\u6CD5"},{default:t(()=>[l(C,{modelValue:e.config.method,"onUpdate:modelValue":a[4]||(a[4]=o=>e.config.method=o),placeholder:"\u8BF7\u9009\u62E9\u8BF7\u6C42\u65B9\u6CD5"},{default:t(()=>[(p(!0),F(D,null,_(e.methodData,o=>(p(),P(v,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"\u8BF7\u6C42\u5730\u5740"},{default:t(()=>[l(r,{modelValue:e.config.url,"onUpdate:modelValue":a[5]||(a[5]=o=>e.config.url=o),placeholder:"\u8BF7\u8F93\u5165\u8BF7\u6C42\u5730\u5740"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u5B9A\u65F6\u8BF7\u6C42"},{default:t(()=>[c("div",ne,[l(r,{modelValue:e.config.cronExpression,"onUpdate:modelValue":a[6]||(a[6]=o=>e.config.cronExpression=o),placeholder:"\u8BF7\u8F93\u5165cron\u8868\u8FBE\u5F0F"},null,8,["modelValue"]),l(g,{type:"success",onClick:a[7]||(a[7]=o=>e.showCron("config")),style:{"margin-left":"5px"}},{default:t(()=>[se]),_:1})])]),_:1}),c("div",de,[c("div",null,[(p(!0),F(D,null,_(e.requestParams,(o,h)=>(p(),F("div",{key:h,style:{padding:"10px",border:"1px solid #eee","margin-bottom":"10px",position:"relative"}},[c("div",re,[l(U,{onClick:n=>e.delParams(h)},{default:t(()=>[l(b)]),_:2},1032,["onClick"])]),c("div",ie,[l(k,{"content-position":"left"},{default:t(()=>[me]),_:1})]),(p(!0),F(D,null,_(o,(n,s)=>(p(),F("div",{class:"content-f",key:s},[l(C,{modelValue:n.type,"onUpdate:modelValue":m=>n.type=m,placeholder:"\u53C2\u6570\u7C7B\u578B",style:{width:"320px"}},{default:t(()=>[(p(!0),F(D,null,_(e.paramData,m=>(p(),P(v,{key:m.value,label:m.label,value:m.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),l(r,{modelValue:n.name,"onUpdate:modelValue":m=>n.name=m,placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u6807\u9898",style:{width:"320px"}},null,8,["modelValue","onUpdate:modelValue"]),l(r,{modelValue:n.key,"onUpdate:modelValue":m=>n.key=m,placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D",style:{width:"320px"}},null,8,["modelValue","onUpdate:modelValue"]),l(r,{modelValue:n.value,"onUpdate:modelValue":m=>n.value=m,placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u503C",style:{width:"320px"}},null,8,["modelValue","onUpdate:modelValue"]),c("div",fe,[l(U,{onClick:m=>e.delParamss(h,s)},{default:t(()=>[l(q)]),_:2},1032,["onClick"])])]))),128)),l(g,{type:"primary",class:"addbutton",onClick:n=>e.addParams(h)},{default:t(()=>[pe]),_:2},1032,["onClick"]),ce]))),128))])]),l(g,{type:"success",class:"addbutton",onClick:e.addParamss},{default:t(()=>[Fe]),_:1},8,["onClick"])])):A("",!0),e.ruleForm.from==4?(p(),F("div",ge,[l(d,{label:"\u9009\u62E9\u8BBE\u5907"},{default:t(()=>[l(C,{modelValue:e.devconfig.deviceKey,"onUpdate:modelValue":a[8]||(a[8]=o=>e.devconfig.deviceKey=o),filterable:"",placeholder:"\u8BF7\u9009\u62E9\u8BBE\u5907",onChange:e.setNode},{default:t(()=>[(p(!0),F(D,null,_(e.sourceData,o=>(p(),P(v,{key:o.id,label:o.key,value:o.id},{default:t(()=>[c("span",be,N(o.name),1),c("span",Ee,N(o.key),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1})])):A("",!0),e.ruleForm.from==2?(p(),F("div",ye,[l(d,{label:"\u6570\u636E\u6765\u6E90",prop:"type"},{default:t(()=>[l(V,{modelValue:e.tabconfig.type,"onUpdate:modelValue":a[9]||(a[9]=o=>e.tabconfig.type=o)},{default:t(()=>[l(y,{label:"mysql"},{default:t(()=>[Be]),_:1}),l(y,{label:"mssql"},{default:t(()=>[Ve]),_:1})]),_:1},8,["modelValue"])]),_:1}),c("div",ve,[l(d,{label:"\u4E3B\u673A\u5730\u5740"},{default:t(()=>[l(r,{modelValue:e.tabconfig.host,"onUpdate:modelValue":a[10]||(a[10]=o=>e.tabconfig.host=o),placeholder:"\u8BF7\u8F93\u5165\u4E3B\u673A\u5730\u5740"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u7AEF\u53E3\u53F7"},{default:t(()=>[l(r,{modelValue:e.tabconfig.port,"onUpdate:modelValue":a[11]||(a[11]=o=>e.tabconfig.port=o),placeholder:"\u8BF7\u8F93\u5165\u7AEF\u53E3\u53F7"},null,8,["modelValue"])]),_:1})]),c("div",Ce,[l(d,{label:"\u7528\u6237\u540D"},{default:t(()=>[l(r,{modelValue:e.tabconfig.user,"onUpdate:modelValue":a[12]||(a[12]=o=>e.tabconfig.user=o),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u5BC6\u7801"},{default:t(()=>[l(r,{modelValue:e.tabconfig.passwd,"onUpdate:modelValue":a[13]||(a[13]=o=>e.tabconfig.passwd=o),placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["modelValue"])]),_:1})]),l(d,{label:"\u6570\u636E\u5E93\u540D\u79F0"},{default:t(()=>[l(r,{modelValue:e.tabconfig.dbName,"onUpdate:modelValue":a[14]||(a[14]=o=>e.tabconfig.dbName=o),placeholder:"\u8BF7\u8F93\u5165\u6570\u636E\u5E93\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u6267\u884C\u65B9\u5F0F",prop:"queryType"},{default:t(()=>[l(V,{modelValue:e.tabconfig.queryType,"onUpdate:modelValue":a[15]||(a[15]=o=>e.tabconfig.queryType=o)},{default:t(()=>[l(y,{label:"tableName"},{default:t(()=>[he]),_:1}),l(y,{label:"sql"},{default:t(()=>[De]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:""},{default:t(()=>[l(r,{modelValue:e.tabconfig.tableName,"onUpdate:modelValue":a[16]||(a[16]=o=>e.tabconfig.tableName=o),type:"textarea",placeholder:e.tabconfig.queryType=="sql"?"\u8BF7\u8F93\u5165sql\u8BED\u53E5":"\u8BF7\u8F93\u5165\u8868\u540D\u79F0"},null,8,["modelValue","placeholder"])]),_:1}),l(d,{label:"\u4E3B\u952E\u5B57\u6BB5"},{default:t(()=>[l(r,{modelValue:e.tabconfig.pk,"onUpdate:modelValue":a[17]||(a[17]=o=>e.tabconfig.pk=o),placeholder:"\u8BF7\u8F93\u5165\u4E3B\u952E\u5B57\u6BB5"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u6BCF\u6B21\u83B7\u53D6\u6570\u91CF"},{default:t(()=>[l(r,{modelValue:e.tabconfig.num,"onUpdate:modelValue":a[18]||(a[18]=o=>e.tabconfig.num=o),placeholder:"\u8BF7\u8F93\u5165\u6BCF\u6B21\u83B7\u53D6\u6570\u91CF"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u4EFB\u52A1\u8868\u8FBE\u5F0F"},{default:t(()=>[c("div",_e,[l(r,{modelValue:e.tabconfig.cronExpression,"onUpdate:modelValue":a[19]||(a[19]=o=>e.tabconfig.cronExpression=o),placeholder:"\u8BF7\u8F93\u5165cron\u4EFB\u52A1\u8868\u8FBE\u5F0F"},null,8,["modelValue"]),l(g,{type:"success",onClick:a[20]||(a[20]=o=>e.showCron("tabconfig")),style:{"margin-left":"5px"}},{default:t(()=>[ke]),_:1})])]),_:1})])):A("",!0)]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),l(w,{modelValue:e.dialogVisible,"onUpdate:modelValue":a[23]||(a[23]=o=>e.dialogVisible=o),title:"\u8FD4\u56DEJson\u6570\u636E",width:"30%"},{footer:t(()=>[c("span",Pe,[l(g,{onClick:a[22]||(a[22]=o=>e.dialogVisible=!1)},{default:t(()=>[Ae]),_:1})])]),default:t(()=>[l(L,{value:e.jsonData,boxed:"",sort:"",theme:"jv-dark",onClick:e.onKeyclick},null,8,["value","onClick"])]),_:1},8,["modelValue"]),l(w,{modelValue:e.cronShow,"onUpdate:modelValue":a[24]||(a[24]=o=>e.cronShow=o),title:"\u9009\u62E9Cron\u89C4\u5219",width:"60%"},{default:t(()=>[l(R,{onHandlelisten:e.handlelisten,type:e.crontype,onClose:e.cronclose},null,8,["onHandlelisten","type","onClose"])]),_:1},8,["modelValue"])])}var Re=J(x,[["render",Se]]);export{Re as default};
