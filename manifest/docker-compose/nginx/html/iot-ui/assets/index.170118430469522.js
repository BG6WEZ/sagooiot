import{_ as B,g as u,E as V}from"./index.1701184304695.js";import{L as C,h as m,i as v,ai as r,o as E,a as P,_ as c,T as f,O as U,e as k,b as z}from"./vue.1701184304695.js";const A={class:"upload"},D=["src"],F=C({__name:"index",props:{multiple:{type:Boolean,default:!1},widthHost:{type:Boolean,default:!0},accept:{type:String,default:".jpg,.png,.jpeg,.gif"},limit:{type:Number,default:1},imgs:{type:Array,default:()=>[]},img:{type:String,default:""}},emits:["setImg","setImgs"],setup(l,{emit:g}){const s=l,h=u("/base-api/api/v1/common/singleImg"),b={Authorization:"Bearer "+localStorage.token},a=m([]),o=()=>{const t=a.value.map(e=>{var i,n;return e.response?u("/base-api/"+((n=(i=e.response)==null?void 0:i.data)==null?void 0:n.path)):e.url});if(s.limit===1){const e=t[0];g("setImg",s.widthHost?e:e.replace(u("/base-api/"),""))}else g("setImgs",t)};v(()=>s.imgs,t=>{t.length?(a.value=t.map(e=>({name:e,url:e})),o()):a.value=[]},{immediate:!0}),v(()=>s.img,t=>{if(t){const e=s.widthHost?t:u("/base-api/"+t);a.value=[{name:e,url:e}],o()}else a.value=[]},{immediate:!0});const _=m(""),p=m(!1),y=t=>{_.value=t.url,p.value=!0},I=t=>t.size/1024/1024>2?(V.error("\u56FE\u7247\u4E0D\u80FD\u8D85\u8FC72MB!"),!1):!0;return(t,e)=>{const i=r("ele-Plus"),n=r("el-icon"),w=r("el-upload"),x=r("el-dialog");return E(),P("div",A,[c(w,{"file-list":a.value,"onUpdate:file-list":e[0]||(e[0]=d=>a.value=d),class:U({hide:a.value.length>=l.limit}),accept:l.accept,"list-type":"picture-card",limit:l.limit,multiple:l.multiple,headers:b,"before-upload":I,action:k(h),"on-success":o,"on-preview":y,"on-remove":o},{default:f(()=>[c(n,null,{default:f(()=>[c(i)]),_:1})]),_:1},8,["file-list","class","accept","limit","multiple","action"]),c(x,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=d=>p.value=d)},{default:f(()=>[z("img",{class:"preview",src:_.value,alt:"Preview Image"},null,8,D)]),_:1},8,["modelValue"])])}}});var S=B(F,[["__scopeId","data-v-05e78b2e"]]);export{S as u};
