import{L as Z,h as S,a as G,_ as e,T as t,e as u,ai as o,as as D,o as s,b as I,aa as O,U as i,S as r,Y as a,Z as Q,ah as Y}from"./vue.1701184304695.js";import{b as k,h as T,E as b}from"./index.1701184304695.js";import{u as j}from"./useCommon.1701184304695.js";import H from"./edit.170118430469516.js";import"./validator.1701184304695.js";import"./index.170118430469522.js";const J={class:"system-plugin-container"},X={class:"system-user-search mb15"},ee=a(" \u67E5\u8BE2 "),te=a(" \u91CD\u7F6E "),le=a(" \u4E0A\u4F20\u63D2\u4EF6ZIP "),ne=a("\u6B63\u5E38"),ue=a("\u505C\u7528"),oe=a("\u5168\u90E8"),ae=a("-"),se=a("\u8BE6\u60C5"),ie=a("\u505C\u7528"),re=a("\u542F\u7528"),de=a("\u5220\u9664"),ce=a("\u7F16\u8F91"),he=Z({__name:"index",setup(_e){const v=S(),z=S();let y=null;const{params:d,tableData:$,getList:c,loading:L}=j(k.plugin.getList,"list",{keyWord:""});c();const x=_=>{_?z.value.open(_):T({title:"\u4E0A\u4F20\u63D2\u4EF6",message:Y("input",{type:"file",accept:".zip",onchange:n=>{y=n.target.files[0]}}),showCancelButton:!0,confirmButtonText:"\u4E0A\u4F20",cancelButtonText:"\u53D6\u6D88",beforeClose:(n,g,F)=>{if(n==="confirm"){if(!y)return b("\u8BF7\u5148\u4E0A\u4F20\u63D2\u4EF6\uFF01");g.confirmButtonLoading=!0,g.confirmButtonText="\u4E0A\u4F20\u4E2D...";const h=new FormData;h.append("file",y),k.plugin.addPluginFile(h).then(()=>{b.success("\u4E0A\u4F20\u6210\u529F"),c(1),F()}).finally(()=>{g.confirmButtonLoading=!1})}else F();y=null}})},A=(_,n)=>{k.plugin.changeStatus({id:_.id,status:n}).then(g=>{b.success("\u64CD\u4F5C\u6210\u529F"),c()})},N=()=>{v.value.resetFields(),c(1)},P=_=>{T.confirm(`\u6B64\u64CD\u4F5C\u5C06\u5220\u9664\u63A5\u53E3\uFF1A\u201C${_.name}\u201D\uFF0C\u662F\u5426\u7EE7\u7EED?`,"\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{await k.plugin.del([_.id]),b.success("\u5220\u9664\u6210\u529F"),c(1)})};return(_,n)=>{const g=o("el-input"),F=o("el-form-item"),h=o("ele-Search"),B=o("el-icon"),p=o("el-button"),R=o("ele-Refresh"),V=o("ele-Plus"),U=o("el-form"),m=o("el-table-column"),C=o("el-tag"),W=o("el-table"),K=o("pagination"),q=o("el-card"),f=D("col"),E=D("auth"),M=D("loading");return s(),G("div",J,[e(q,{shadow:"hover"},{default:t(()=>[I("div",X,[e(U,{model:u(d),ref_key:"queryRef",ref:v,inline:!0,"label-width":"68px"},{default:t(()=>[e(F,{label:"\u5173\u952E\u5B57",prop:"keyWord"},{default:t(()=>[e(g,{modelValue:u(d).keyWord,"onUpdate:modelValue":n[0]||(n[0]=l=>u(d).keyWord=l),placeholder:"\u8BF7\u8F93\u5165\u5173\u952E\u5B57",clearable:"",style:{width:"180px"},size:"default",onKeyup:O(u(c),["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(F,null,{default:t(()=>[e(p,{size:"default",type:"primary",class:"ml10",onClick:u(c)},{default:t(()=>[e(B,null,{default:t(()=>[e(h)]),_:1}),ee]),_:1},8,["onClick"]),e(p,{size:"default",onClick:n[1]||(n[1]=l=>N())},{default:t(()=>[e(B,null,{default:t(()=>[e(R)]),_:1}),te]),_:1}),e(p,{size:"default",type:"success",onClick:n[2]||(n[2]=l=>x())},{default:t(()=>[e(B,null,{default:t(()=>[e(V)]),_:1}),le]),_:1})]),_:1})]),_:1},8,["model"])]),i((s(),r(W,{data:u($),style:{width:"100%"}},{default:t(()=>[e(m,{label:"\u5E8F\u53F7",align:"center",width:"80"},{default:t(({$index:l})=>[a(Q(u(d).pageSize*(u(d).pageNum-1)+(l+1)),1)]),_:1}),i(e(m,{label:"\u540D\u79F0",align:"center",prop:"name"},null,512),[[f,"name"]]),i(e(m,{label:"\u901A\u4FE1\u65B9\u5F0F",align:"center",prop:"types"},null,512),[[f,"types"]]),i(e(m,{label:"\u529F\u80FD\u7C7B\u578B",align:"center",prop:"handleType"},null,512),[[f,"handleType"]]),i(e(m,{label:"\u8BF4\u660E","show-overflow-tooltip":"",align:"left",prop:"description"},null,512),[[f,"description"]]),i(e(m,{label:"\u4F5C\u8005",align:"center",prop:"author"},null,512),[[f,"author"]]),i((s(),r(m,{label:"\u72B6\u6001",align:"center",prop:"status",width:"80"},{default:t(l=>[l.row.status===1?(s(),r(C,{key:0,type:"success",size:"small"},{default:t(()=>[ne]),_:1})):l.row.status===0?(s(),r(C,{key:1,type:"error",size:"small"},{default:t(()=>[ue]),_:1})):l.row.status===-1?(s(),r(C,{key:2,type:"info",size:"small"},{default:t(()=>[oe]),_:1})):(s(),r(C,{key:3,type:"info",size:"small"},{default:t(()=>[ae]),_:1}))]),_:1})),[[f,"status"]]),i((s(),r(m,{label:"\u64CD\u4F5C",width:"240",align:"center",fixed:"right"},{default:t(l=>[i((s(),r(p,{size:"small",type:"primary",link:""},{default:t(()=>[se]),_:1})),[[E,"detail"]]),i((s(),r(p,{disabled:l.row.status==0,type:"warning",size:"small",link:"",onClick:w=>A(l.row,0)},{default:t(()=>[ie]),_:2},1032,["disabled","onClick"])),[[E,"stop"]]),i((s(),r(p,{disabled:l.row.status==1,size:"small",type:"success",link:"",onClick:w=>A(l.row,1)},{default:t(()=>[re]),_:2},1032,["disabled","onClick"])),[[E,"start"]]),i((s(),r(p,{disabled:l.row.status==1,size:"small",type:"danger",link:"",onClick:w=>P(l.row)},{default:t(()=>[de]),_:2},1032,["disabled","onClick"])),[[E,"del"]]),e(p,{size:"small",type:"plain",link:"",onClick:w=>x(l.row)},{default:t(()=>[ce]),_:2},1032,["onClick"])]),_:1})),[[f,"handle"]])]),_:1},8,["data"])),[[M,u(L)]]),e(K,{total:u(d).total,page:u(d).pageNum,"onUpdate:page":n[3]||(n[3]=l=>u(d).pageNum=l),limit:u(d).pageSize,"onUpdate:limit":n[4]||(n[4]=l=>u(d).pageSize=l),onPagination:u(c)},null,8,["total","page","limit","onPagination"])]),_:1}),e(H,{ref_key:"editFormRef",ref:z,onGetList:n[5]||(n[5]=l=>u(c)())},null,512)])}}});export{he as default};
