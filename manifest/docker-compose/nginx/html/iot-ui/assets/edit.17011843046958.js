import{_ as _sfc_main$1}from"./index.170118430469524.js";import serverDetail from"./serverDetail.1701184304695.js";import{L as defineComponent,a2 as reactive,h as ref,i as watch,k as onMounted,ab as toRefs,S as createBlock,T as withCtx,j as getCurrentInstance,aD as useRoute,aF as useRouter,ai as resolveComponent,o as openBlock,_ as createVNode,b as createBaseVNode,a as createElementBlock,a8 as renderList,F as Fragment,X as createCommentVNode,Y as createTextVNode}from"./vue.1701184304695.js";import{a as api}from"./index.170118430469527.js";import{_ as _export_sfc,E as ElMessage}from"./index.1701184304695.js";var edit_vue_vue_type_style_index_0_scoped_true_lang="";const _sfc_main=defineComponent({name:"serverCreate",components:{codeEditor:_sfc_main$1,serverDetail},props:{type:{type:String,default:""}},setup(props,context){const{proxy}=getCurrentInstance(),route=useRoute(),router=useRouter(),{network_server_type,network_protocols}=proxy.useDict("network_server_type","network_protocols"),state=reactive({stickValue:"",stick:{"delimit,omitempty":"","custom,omitempty":"","fixedLen,omitempty":0,"len,omitempty":{len:0,offset:0,endian:""}},stick_type:[{label:"\u5206\u9694\u7B26",value:"\u5206\u9694\u7B26"},{label:"\u81EA\u5B9A\u4E49\u811A\u672C",value:"\u81EA\u5B9A\u4E49\u811A\u672C"},{label:"\u56FA\u5B9A\u957F\u5EA6",value:"\u56FA\u5B9A\u957F\u5EA6"},{label:"\u957F\u5EA6\u5B57\u6BB5",value:"\u957F\u5EA6\u5B57\u6BB5"}],resourceModalPro:{mode:"",content:""},certificateList:[],detail:{},activeViewName:["1","2","3"],form:{name:"\u65B0\u5EFA\u670D\u52A1\u5668",accessToken:"",authPasswd:"",authUser:"",authType:3,isTls:0,certificateId:"",types:"tcp",status:!1,addr:"",register:{regex:"^w+$"},protocol:{name:"ModbusTCP",options:{}},heartbeat:{enable:!1,hex:"",regex:"^\\w+$",text:"",timeout:30},devices:[]}}),mirrorRef=ref("mirrorRef"),activeName=ref("first"),getDetail=()=>{const e=route.params&&route.params.id;api.server.getDetail({id:e}).then(o=>{const{id:k,isTls:C,authType:y,certificateId:F,authUser:a,authPasswd:l,accessToken:r,name:s,types:m,status:p,addr:c,register:d,protocol:n,heartbeat:f,devices:V,stick:B}=o;state.form.id=k,state.form.name=s,state.form.types=m,state.form.status=p,state.form.isTls=C,state.form.addr=c,state.form.authType=y,state.form.authUser=a,state.form.authPasswd=l,state.form.accessToken=r,state.form.certificateId=F,state.form.register=JSON.parse(d),state.form.protocol=JSON.parse(n),state.form.heartbeat=JSON.parse(f),state.form.devices=JSON.parse(V);let u=JSON.parse(B);u.len&&u.len.endian?state.stick["len,omitempty"]=u.len:u.fixedLen?state.stick["fixedLen,omitempty"]=u.fixedLen:u.custom?state.stick["custom,omitempty"]=u.custom:u.delimit&&(state.stick["delimit,omitempty"]=u.delimit),m=="tcp"&&(state.stick["delimit,omitempty"]?state.stickValue="\u5206\u9694\u7B26":state.stick["custom,omitempty"]?state.stickValue="\u81EA\u5B9A\u4E49\u811A\u672C":state.stick["fixedLen,omitempty"]?state.stickValue="\u56FA\u5B9A\u957F\u5EA6":state.stick["len,omitempty"]&&(state.stickValue="\u957F\u5EA6\u5B57\u6BB5"));let i=JSON.stringify(JSON.parse(n).options);state.resourceModalPro.content=JSON.stringify(JSON.parse(i),null,4),mirrorRef.value.setValue(state.resourceModalPro.content)})},submit=()=>{let params={...state.form,stick:{...state.stick}};mirrorRef.value.getValue()&&(state.form.protocol.options=eval("("+mirrorRef.value.getValue()+")")),api.server.editItem(params).then(e=>{ElMessage.success("\u4FEE\u6539\u6210\u529F"),router.go(-1)})},initData=()=>{state.stick={"delimit,omitempty":"","custom,omitempty":"","fixedLen,omitempty":0,"len,omitempty":{len:0,offset:0,endian:""}}},handleChangeType=()=>{if(state.form.types!="mqtt_server"&&state.form.isTls==1){state.form.authType=3;return}state.form.isTls==0&&(state.form.authType="")},getCertificateList=()=>{};return watch(()=>state.form.isTls,e=>{e==0&&(state.form.authType="")}),onMounted(()=>{getDetail()}),{mirrorRef,activeName,getDetail,network_server_type,network_protocols,submit,initData,handleChangeType,getCertificateList,...toRefs(props),...toRefs(state)}}}),_hoisted_1={class:"collapse-wrap"},_hoisted_2=createTextVNode("\u662F"),_hoisted_3=createTextVNode("\u5426"),_hoisted_4={style:{position:"absolute",right:"20px",top:"20px"}},_hoisted_5=createTextVNode("\u53D6\u6D88"),_hoisted_6=createTextVNode("\u63D0\u4EA4");function _sfc_render(e,o,k,C,y,F){const a=resolveComponent("el-input"),l=resolveComponent("el-form-item"),r=resolveComponent("el-option"),s=resolveComponent("el-select"),m=resolveComponent("el-radio"),p=resolveComponent("el-radio-group"),c=resolveComponent("el-switch"),d=resolveComponent("el-form"),n=resolveComponent("el-collapse-item"),f=resolveComponent("codeEditor"),V=resolveComponent("el-collapse"),B=resolveComponent("el-tab-pane"),u=resolveComponent("el-tabs"),i=resolveComponent("el-button"),N=resolveComponent("el-card");return openBlock(),createBlock(N,{class:"system-dic-container",style:{position:"relative"}},{default:withCtx(()=>[createVNode(u,{modelValue:e.activeName,"onUpdate:modelValue":o[20]||(o[20]=t=>e.activeName=t),class:"demo-tabs"},{default:withCtx(()=>[createVNode(B,{label:"\u7F16\u8F91\u670D\u52A1\u5668",name:"first"},{default:withCtx(()=>[createVNode(V,{modelValue:e.activeViewName,"onUpdate:modelValue":o[19]||(o[19]=t=>e.activeViewName=t)},{default:withCtx(()=>[createVNode(n,{title:"\u57FA\u672C\u4FE1\u606F",name:"1"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1,[createVNode(d,{style:{width:"600px",margin:"0 auto"},model:e.form,"label-width":"98px"},{default:withCtx(()=>[createVNode(l,{label:"\u540D\u79F0"},{default:withCtx(()=>[createVNode(a,{modelValue:e.form.name,"onUpdate:modelValue":o[0]||(o[0]=t=>e.form.name=t),placeholder:"\u8BF7\u586B\u5199\u540D\u79F0"},null,8,["modelValue"])]),_:1}),createVNode(l,{label:"\u7C7B\u578B"},{default:withCtx(()=>[createVNode(s,{onChange:e.handleChangeType,modelValue:e.form.types,"onUpdate:modelValue":o[1]||(o[1]=t=>e.form.types=t),placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.network_server_type,t=>(openBlock(),createBlock(r,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])]),_:1}),e.form.types=="tcp"?(openBlock(),createBlock(l,{key:0,label:"\u7C98\u62C6\u5305\u89C4\u5219"},{default:withCtx(()=>[createVNode(s,{onChange:e.initData,modelValue:e.stickValue,"onUpdate:modelValue":o[2]||(o[2]=t=>e.stickValue=t),placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.stick_type,t=>(openBlock(),createBlock(r,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])]),_:1})):createCommentVNode("",!0),e.form.types=="tcp"&&e.stickValue?(openBlock(),createBlock(l,{key:1},{default:withCtx(()=>[e.stickValue=="\u5206\u9694\u7B26"?(openBlock(),createBlock(l,{key:0,class:"flex-column",label:"\u5206\u9694\u7B26"},{default:withCtx(()=>[createVNode(a,{modelValue:e.stick["delimit,omitempty"],"onUpdate:modelValue":o[3]||(o[3]=t=>e.stick["delimit,omitempty"]=t),placeholder:"\u8BF7\u586B\u5199\u5206\u9694\u7B26"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.stickValue=="\u81EA\u5B9A\u4E49\u811A\u672C"?(openBlock(),createBlock(l,{key:1,class:"flex-column",label:"\u81EA\u5B9A\u4E49\u811A\u672C"},{default:withCtx(()=>[createVNode(a,{modelValue:e.stick["custom,omitempty"],"onUpdate:modelValue":o[4]||(o[4]=t=>e.stick["custom,omitempty"]=t),placeholder:"\u8BF7\u586B\u5199\u81EA\u5B9A\u4E49\u811A\u672C"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.stickValue=="\u56FA\u5B9A\u957F\u5EA6"?(openBlock(),createBlock(l,{key:2,class:"flex-column",label:"\u56FA\u5B9A\u957F\u5EA6"},{default:withCtx(()=>[createVNode(a,{type:"number",modelValue:e.stick["fixedLen,omitempty"],"onUpdate:modelValue":o[5]||(o[5]=t=>e.stick["fixedLen,omitempty"]=t),placeholder:"\u8BF7\u586B\u5199\u56FA\u5B9A\u957F\u5EA6"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.stickValue=="\u957F\u5EA6\u5B57\u6BB5"?(openBlock(),createBlock(l,{key:3,class:"flex-column",label:"\u957F\u5EA6"},{default:withCtx(()=>[createVNode(a,{type:"number",modelValue:e.stick["len,omitempty"].len,"onUpdate:modelValue":o[6]||(o[6]=t=>e.stick["len,omitempty"].len=t),placeholder:"\u8BF7\u586B\u5199\u957F\u5EA6"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.stickValue=="\u957F\u5EA6\u5B57\u6BB5"?(openBlock(),createBlock(l,{key:4,class:"flex-column",label:"\u504F\u79FB\u91CF"},{default:withCtx(()=>[createVNode(a,{type:"number",modelValue:e.stick["len,omitempty"].offset,"onUpdate:modelValue":o[7]||(o[7]=t=>e.stick["len,omitempty"].offset=t),placeholder:"\u8BF7\u586B\u5199\u504F\u79FB\u91CF"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.stickValue=="\u957F\u5EA6\u5B57\u6BB5"?(openBlock(),createBlock(l,{key:5,class:"flex-column",label:"\u5927\u5C0F\u7AEF"},{default:withCtx(()=>[createVNode(s,{modelValue:e.stick["len,omitempty"].endian,"onUpdate:modelValue":o[8]||(o[8]=t=>e.stick["len,omitempty"].endian=t),placeholder:"\u8BF7\u9009\u62E9\u5927\u5C0F\u7AEF"},{default:withCtx(()=>[createVNode(r,{label:"\u5927\u7AEF",value:"\u5927\u7AEF"}),createVNode(r,{label:"\u5C0F\u7AEF",value:"\u5C0F\u7AEF"})]),_:1},8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1})):createCommentVNode("",!0),createVNode(l,{label:"\u5730\u5740"},{default:withCtx(()=>[createVNode(a,{modelValue:e.form.addr,"onUpdate:modelValue":o[9]||(o[9]=t=>e.form.addr=t),placeholder:"\u7AEF\u53E3\u53F7"},null,8,["modelValue"])]),_:1}),createVNode(l,{label:"\u5F00\u542FTLS"},{default:withCtx(()=>[createVNode(p,{modelValue:e.form.isTls,"onUpdate:modelValue":o[10]||(o[10]=t=>e.form.isTls=t),class:"ml-4"},{default:withCtx(()=>[createVNode(m,{label:1},{default:withCtx(()=>[_hoisted_2]),_:1}),createVNode(m,{label:0},{default:withCtx(()=>[_hoisted_3]),_:1})]),_:1},8,["modelValue"])]),_:1}),e.form.isTls==1&&e.form.types!="mqtt_server"?(openBlock(),createBlock(l,{key:2,label:"\u9009\u62E9\u8BC1\u4E66"},{default:withCtx(()=>[createVNode(s,{modelValue:e.form.certificateId,"onUpdate:modelValue":o[11]||(o[11]=t=>e.form.certificateId=t),placeholder:"\u8BF7\u9009\u62E9\u8BC1\u4E66"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.certificateList,t=>(openBlock(),createBlock(r,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.form.isTls==1&&e.form.types=="mqtt_server"?(openBlock(),createBlock(l,{key:3,label:"\u63A5\u5165\u65B9\u5F0F"},{default:withCtx(()=>[createVNode(s,{modelValue:e.form.authType,"onUpdate:modelValue":o[12]||(o[12]=t=>e.form.authType=t),placeholder:"\u9009\u62E9\u63A5\u5165\u65B9\u5F0F"},{default:withCtx(()=>[createVNode(r,{label:"Basic",value:1}),createVNode(r,{label:"AccessToken",value:2})]),_:1},8,["modelValue"]),e.form.authType==1?(openBlock(),createBlock(l,{key:0,class:"flex-column",label:"\u7528\u6237\u540D"},{default:withCtx(()=>[createVNode(a,{modelValue:e.form.authUser,"onUpdate:modelValue":o[13]||(o[13]=t=>e.form.authUser=t),placeholder:"\u8BF7\u586B\u5199\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.form.authType==1?(openBlock(),createBlock(l,{key:1,class:"flex-column",label:"\u5BC6\u7801"},{default:withCtx(()=>[createVNode(a,{modelValue:e.form.authPasswd,"onUpdate:modelValue":o[14]||(o[14]=t=>e.form.authPasswd=t),placeholder:"\u8BF7\u586B\u5199\u5BC6\u7801"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.form.authType==2?(openBlock(),createBlock(l,{key:2,class:"flex-column",label:"Aceess Token"},{default:withCtx(()=>[createVNode(a,{modelValue:e.form.accessToken,"onUpdate:modelValue":o[15]||(o[15]=t=>e.form.accessToken=t),placeholder:"\u8BF7\u586B\u5199Aceess Token"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1})):createCommentVNode("",!0),createVNode(l,{label:"\u542F\u7528"},{default:withCtx(()=>[createVNode(c,{"active-value":1,"inactive-value":0,modelValue:e.form.status,"onUpdate:modelValue":o[16]||(o[16]=t=>e.form.status=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1}),createVNode(n,{title:"\u6CE8\u518C\u5305",name:"2"},{default:withCtx(()=>[createVNode(d,{style:{width:"600px",margin:"0 auto"},model:e.form,"label-width":"98px"},{default:withCtx(()=>[createVNode(l,{label:"\u6B63\u5219\u8868\u8FBE\u5F0F"},{default:withCtx(()=>[createVNode(a,{modelValue:e.form.register.regex,"onUpdate:modelValue":o[17]||(o[17]=t=>e.form.register.regex=t),placeholder:"\u8BF7\u586B\u5199\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),createVNode(n,{title:"\u534F\u8BAE\u9002\u914D",name:"3"},{default:withCtx(()=>[createVNode(d,{style:{width:"600px",margin:"0 auto"},model:e.form,"label-width":"98px"},{default:withCtx(()=>[createVNode(l,{label:"\u534F\u8BAE"},{default:withCtx(()=>[createVNode(s,{modelValue:e.form.protocol.name,"onUpdate:modelValue":o[18]||(o[18]=t=>e.form.protocol.name=t),placeholder:"\u8BF7\u9009\u62E9\u534F\u8BAE\u9002\u914D"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.network_protocols,t=>(openBlock(),createBlock(r,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),createVNode(l,{label:"\u534F\u8BAE\u53C2\u6570"},{default:withCtx(()=>[createVNode(f,{class:"params",ref:"mirrorRef",mode:e.resourceModalPro.mode,content:e.resourceModalPro.content},null,8,["mode","content"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),createBaseVNode("div",_hoisted_4,[createVNode(i,{size:"medium"},{default:withCtx(()=>[_hoisted_5]),_:1}),createVNode(i,{onClick:e.submit,size:"medium",type:"primary"},{default:withCtx(()=>[_hoisted_6]),_:1},8,["onClick"])])]),_:1})}var edit=_export_sfc(_sfc_main,[["render",_sfc_render],["__scopeId","data-v-b3de604c"]]);export{edit as default};
