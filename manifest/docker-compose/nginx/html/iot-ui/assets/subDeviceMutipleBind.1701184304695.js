import{L as K,a2 as N,ab as V,a as C,_ as u,T as n,aD as z,ai as i,as as h,o as r,F as T,a8 as U,S as p,U as s,X as _,V as $,Y as D}from"./vue.1701184304695.js";/* empty css                    */import{a as B}from"./index.170118430469519.js";import{_ as M,E as v,h as R}from"./index.1701184304695.js";const P=K({name:"MutipleBindDialog",setup(t,{emit:l}){z();const e=N({gatewayKey:"",deviceKeyList:[],isShowDialog:!1,productData:[],tableData:{data:[],total:0,loading:!1,param:{pageNum:1,pageSize:10,productId:0,status:"",dateRange:[]}},ruleForm:{productId:""},rules:{productId:[{required:!0,message:"\u6240\u5C5E\u4EA7\u54C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),g=()=>{if(!e.ruleForm.productId){e.tableData.data=[],e.tableData.total=0;return}e.tableData.loading=!0,B.device.getSubList({productId:e.ruleForm.productId,pageSize:e.tableData.param.pageSize,pageNum:e.tableData.param.pageNum}).then(o=>{e.tableData.data=o.device,e.tableData.total=o.Total}).finally(()=>e.tableData.loading=!1)},f=()=>{B.product.getSubList().then(o=>{let c=o.product;e.productData=c,e.ruleForm.productId=e.productData[0].id,g(),e.isShowDialog=!0})};return{openDialog:o=>{e.gatewayKey=o,f()},getProductList:f,confirmBind:()=>{let o="\u662F\u5426\u8FDB\u884C\u6279\u91CF\u7ED1\u5B9A\uFF1F";if(e.deviceKeyList.length===0){v.error("\u8BF7\u9009\u62E9\u8981\u6279\u91CF\u7ED1\u5B9A\u7684\u6570\u636E\u3002");return}R.confirm(o,"\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{B.device.mutipleBind({gatewayKey:e.gatewayKey,subKeys:e.deviceKeyList}).then(()=>{v.success("\u7ED1\u5B9A\u6210\u529F"),l("bindSuccess"),e.isShowDialog=!1})}).catch(()=>{})},getDeviceList:g,handleSelectionChange:o=>{e.deviceKeyList=o.map(c=>c.key)},handleChange:o=>{e.ruleForm.productId=o,g()},...V(e)}}}),q={class:"mutiple-bind-dialog-wrap"},X=D("\u6279\u91CF\u7ED1\u5B9A"),Y=D("\u79BB\u7EBF"),j=D("\u5728\u7EBF"),G=D("\u672A\u542F\u7528");function H(t,l,e,g,f,E){const y=i("el-option"),F=i("el-select"),w=i("el-button"),o=i("el-form-item"),c=i("el-form"),d=i("el-table-column"),b=i("el-tag"),S=i("el-table"),A=i("pagination"),L=i("el-dialog"),k=h("auth"),m=h("col"),I=h("loading");return r(),C("div",q,[u(L,{title:"\u6279\u91CF\u7ED1\u5B9A\u5B50\u8BBE\u5907",modelValue:t.isShowDialog,"onUpdate:modelValue":l[4]||(l[4]=a=>t.isShowDialog=a),width:"90%"},{default:n(()=>[u(c,{model:t.ruleForm,ref:"formRef",rules:t.rules,size:"small","label-width":"110px"},{default:n(()=>[u(o,{label:"\u6240\u5C5E\u4EA7\u54C1",prop:"productId"},{default:n(()=>[u(F,{onChange:t.handleChange,modelValue:t.ruleForm.productId,"onUpdate:modelValue":l[0]||(l[0]=a=>t.ruleForm.productId=a),placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u4EA7\u54C1",style:{width:"300px"}},{default:n(()=>[(r(!0),C(T,null,U(t.productData,a=>(r(),p(y,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"]),s((r(),p(w,{style:{"margin-left":"20px"},disabled:!t.deviceKeyList.length,type:"primary",onClick:l[1]||(l[1]=a=>t.confirmBind())},{default:n(()=>[X]),_:1},8,["disabled"])),[[k,"mutipleBind"]])]),_:1})]),_:1},8,["model","rules"]),s((r(),p(S,{data:t.tableData.data,style:{width:"100%"},onSelectionChange:t.handleSelectionChange},{default:n(()=>[u(d,{type:"selection",width:"55",align:"center"}),s(u(d,{label:"\u6807\u8BC6",prop:"key",width:"130","show-overflow-tooltip":!0},null,512),[[m,"key"]]),s(u(d,{label:"\u8BBE\u5907\u540D\u79F0",prop:"name","show-overflow-tooltip":!0},null,512),[[m,"name"]]),s(u(d,{label:"\u4EA7\u54C1\u540D\u79F0",prop:"productName","show-overflow-tooltip":!0},null,512),[[m,"productName"]]),s((r(),p(d,{prop:"status",label:"\u72B6\u6001",width:"100",align:"center"},{default:n(a=>[a.row.status==1?(r(),p(b,{key:0,type:"info",size:"small"},{default:n(()=>[Y]),_:1})):_("",!0),a.row.status==2?(r(),p(b,{key:1,type:"success",size:"small"},{default:n(()=>[j]),_:1})):_("",!0),a.row.status==0?(r(),p(b,{key:2,type:"info",size:"small"},{default:n(()=>[G]),_:1})):_("",!0)]),_:1})),[[m,"status"]]),s(u(d,{prop:"registryTime",label:"\u6FC0\u6D3B\u65F6\u95F4",align:"center",width:"150"},null,512),[[m,"registryTime"]]),s(u(d,{prop:"desc",label:"\u8BF4\u660E"},null,512),[[m,"desc"]])]),_:1},8,["data","onSelectionChange"])),[[I,t.tableData.loading]]),s(u(A,{total:t.tableData.total,page:t.tableData.param.pageNum,"onUpdate:page":l[2]||(l[2]=a=>t.tableData.param.pageNum=a),limit:t.tableData.param.pageSize,"onUpdate:limit":l[3]||(l[3]=a=>t.tableData.param.pageSize=a),onPagination:t.getDeviceList},null,8,["total","page","limit","onPagination"]),[[$,t.tableData.total>0]])]),_:1},8,["modelValue"])])}var Z=M(P,[["render",H]]);export{Z as default};
