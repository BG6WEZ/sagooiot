import{_ as _export_sfc,F as edit_default,E as ElMessage}from"./index.1701184304695.js";import{_ as _sfc_main$1}from"./index.170118430469524.js";import serverDetail from"./serverDetail.1701184304695.js";import{L as defineComponent,a2 as reactive,h as ref,k as onMounted,i as watch,ab as toRefs,S as createBlock,T as withCtx,j as getCurrentInstance,aD as useRoute,aF as useRouter,ai as resolveComponent,o as openBlock,_ as createVNode,b as createBaseVNode,a as createElementBlock,a8 as renderList,F as Fragment,X as createCommentVNode,Y as createTextVNode}from"./vue.1701184304695.js";import{a as api}from"./index.170118430469527.js";var create_vue_vue_type_style_index_0_lang="",create_vue_vue_type_style_index_1_scoped_true_lang="";const _sfc_main=defineComponent({name:"serverCreate",components:{codeEditor:_sfc_main$1,serverDetail},props:{type:{type:String,default:""}},setup(props,context){const{proxy}=getCurrentInstance(),route=useRoute(),router=useRouter(),{network_server_type,network_protocols}=proxy.useDict("network_server_type","network_protocols"),state=reactive({stickValue:"",stick:{"delimit,omitempty":"","custom,omitempty":"","fixedLen,omitempty":0,"len,omitempty":{len:0,offset:0,endian:""}},stick_type:[{label:"\u5206\u9694\u7B26",value:"\u5206\u9694\u7B26"},{label:"\u81EA\u5B9A\u4E49\u811A\u672C",value:"\u81EA\u5B9A\u4E49\u811A\u672C"},{label:"\u56FA\u5B9A\u957F\u5EA6",value:"\u56FA\u5B9A\u957F\u5EA6"},{label:"\u957F\u5EA6\u5B57\u6BB5",value:"\u957F\u5EA6\u5B57\u6BB5"}],resourceModalPro:{mode:"",content:""},detail:{},activeViewName:["1","2","3"],certificateList:[],form:{id:"",accessToken:"",authPasswd:"",authUser:"",authType:3,isTls:0,certificateId:"",name:"\u65B0\u5EFA\u670D\u52A1\u5668",types:"tcp",status:0,addr:"",register:{regex:"^w+$"},protocol:{name:"ModbusTCP",options:{}},heartbeat:{enable:!1,hex:"",regex:"^\\w+$",text:"",timeout:30},devices:[]}}),mirrorRef=ref("mirrorRef"),activeName=ref("first"),getDetail=()=>{const e=route.params&&route.params.id;api.tunnel.getDetail({id:e}).then(o=>{state.detail=o})},submit=()=>{state.form.id||delete state.form.id;let params={...state.form,stick:{...state.stick}};mirrorRef.value.getValue()&&(state.form.protocol.options=eval("("+mirrorRef.value.getValue()+")")),api.server.addItem(params).then(e=>{ElMessage.success("\u6DFB\u52A0\u6210\u529F"),router.go(-1)})};onMounted(()=>{let e={};var o=JSON.stringify(e);state.resourceModalPro.content=JSON.stringify(JSON.parse(o),null,4),getCertificateList()});const handleClick=(e,o)=>{},getCertificateList=()=>{},initData=()=>{state.stick={"delimit,omitempty":"","custom,omitempty":"","fixedLen,omitempty":0,"len,omitempty":{len:0,offset:0,endian:""}}},handleChangeType=()=>{if(state.form.types!="mqtt_server"&&state.form.isTls==1){state.form.authType=3;return}state.form.isTls==0&&(state.form.authType="")};return watch(()=>state.form.types,e=>{}),watch(()=>state.form.isTls,e=>{e==0&&(state.form.authType="")}),{Edit:edit_default,mirrorRef,activeName,getDetail,handleClick,network_server_type,network_protocols,getCertificateList,submit,initData,handleChangeType,...toRefs(props),...toRefs(state)}}}),_hoisted_1={class:"collapse-wrap"},_hoisted_2=createTextVNode("\u662F"),_hoisted_3=createTextVNode("\u5426"),_hoisted_4={style:{position:"absolute",right:"20px",top:"20px"}},_hoisted_5=createTextVNode("\u53D6\u6D88"),_hoisted_6=createTextVNode("\u63D0\u4EA4");function _sfc_render(e,o,k,y,F,v){const a=resolveComponent("el-input"),l=resolveComponent("el-form-item"),u=resolveComponent("el-option"),r=resolveComponent("el-select"),d=resolveComponent("el-radio"),i=resolveComponent("el-radio-group"),p=resolveComponent("el-switch"),n=resolveComponent("el-form"),s=resolveComponent("el-collapse-item"),c=resolveComponent("codeEditor"),f=resolveComponent("el-collapse"),V=resolveComponent("el-tab-pane"),B=resolveComponent("el-tabs"),m=resolveComponent("el-button"),C=resolveComponent("el-card");return openBlock(),createBlock(C,{class:"system-dic-container",style:{position:"relative"}},{default:withCtx(()=>[createVNode(B,{modelValue:e.activeName,"onUpdate:modelValue":o[20]||(o[20]=t=>e.activeName=t),class:"demo-tabs",onTabClick:e.handleClick},{default:withCtx(()=>[createVNode(V,{label:"\u65B0\u5EFA\u670D\u52A1\u5668",name:"first"},{default:withCtx(()=>[createVNode(f,{modelValue:e.activeViewName,"onUpdate:modelValue":o[19]||(o[19]=t=>e.activeViewName=t)},{default:withCtx(()=>[createVNode(s,{title:"\u57FA\u672C\u4FE1\u606F",name:"1"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1,[createVNode(n,{style:{width:"600px",margin:"0 auto"},model:e.form,"label-width":"98px"},{default:withCtx(()=>[createVNode(l,{label:"\u540D\u79F0"},{default:withCtx(()=>[createVNode(a,{modelValue:e.form.name,"onUpdate:modelValue":o[0]||(o[0]=t=>e.form.name=t),placeholder:"\u8BF7\u586B\u5199\u540D\u79F0"},null,8,["modelValue"])]),_:1}),createVNode(l,{label:"\u7C7B\u578B"},{default:withCtx(()=>[createVNode(r,{onChange:e.handleChangeType,modelValue:e.form.types,"onUpdate:modelValue":o[1]||(o[1]=t=>e.form.types=t),placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.network_server_type,t=>(openBlock(),createBlock(u,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])]),_:1}),e.form.types=="tcp"?(openBlock(),createBlock(l,{key:0,label:"\u7C98\u62C6\u5305\u89C4\u5219"},{default:withCtx(()=>[createVNode(r,{onChange:e.initData,modelValue:e.stickValue,"onUpdate:modelValue":o[2]||(o[2]=t=>e.stickValue=t),placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.stick_type,t=>(openBlock(),createBlock(u,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])]),_:1})):createCommentVNode("",!0),e.form.types=="tcp"&&e.stickValue?(openBlock(),createBlock(l,{key:1},{default:withCtx(()=>[e.stickValue=="\u5206\u9694\u7B26"?(openBlock(),createBlock(l,{key:0,class:"flex-column",label:"\u5206\u9694\u7B26"},{default:withCtx(()=>[createVNode(a,{modelValue:e.stick["delimit,omitempty"],"onUpdate:modelValue":o[3]||(o[3]=t=>e.stick["delimit,omitempty"]=t),placeholder:"\u8BF7\u586B\u5199\u5206\u9694\u7B26"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.stickValue=="\u81EA\u5B9A\u4E49\u811A\u672C"?(openBlock(),createBlock(l,{key:1,class:"flex-column",label:"\u81EA\u5B9A\u4E49\u811A\u672C"},{default:withCtx(()=>[createVNode(a,{modelValue:e.stick["custom,omitempty"],"onUpdate:modelValue":o[4]||(o[4]=t=>e.stick["custom,omitempty"]=t),placeholder:"\u8BF7\u586B\u5199\u81EA\u5B9A\u4E49\u811A\u672C"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.stickValue=="\u56FA\u5B9A\u957F\u5EA6"?(openBlock(),createBlock(l,{key:2,class:"flex-column",label:"\u56FA\u5B9A\u957F\u5EA6"},{default:withCtx(()=>[createVNode(a,{type:"number",modelValue:e.stick["fixedLen,omitempty"],"onUpdate:modelValue":o[5]||(o[5]=t=>e.stick["fixedLen,omitempty"]=t),placeholder:"\u8BF7\u586B\u5199\u56FA\u5B9A\u957F\u5EA6"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.stickValue=="\u957F\u5EA6\u5B57\u6BB5"?(openBlock(),createBlock(l,{key:3,class:"flex-column",label:"\u957F\u5EA6"},{default:withCtx(()=>[createVNode(a,{type:"number",modelValue:e.stick["len,omitempty"].len,"onUpdate:modelValue":o[6]||(o[6]=t=>e.stick["len,omitempty"].len=t),placeholder:"\u8BF7\u586B\u5199\u957F\u5EA6"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.stickValue=="\u957F\u5EA6\u5B57\u6BB5"?(openBlock(),createBlock(l,{key:4,class:"flex-column",label:"\u504F\u79FB\u91CF"},{default:withCtx(()=>[createVNode(a,{type:"number",modelValue:e.stick["len,omitempty"].offset,"onUpdate:modelValue":o[7]||(o[7]=t=>e.stick["len,omitempty"].offset=t),placeholder:"\u8BF7\u586B\u5199\u504F\u79FB\u91CF"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.stickValue=="\u957F\u5EA6\u5B57\u6BB5"?(openBlock(),createBlock(l,{key:5,class:"flex-column",label:"\u5927\u5C0F\u7AEF"},{default:withCtx(()=>[createVNode(r,{modelValue:e.stick["len,omitempty"].endian,"onUpdate:modelValue":o[8]||(o[8]=t=>e.stick["len,omitempty"].endian=t),placeholder:"\u8BF7\u9009\u62E9\u5927\u5C0F\u7AEF"},{default:withCtx(()=>[createVNode(u,{label:"\u5927\u7AEF",value:"\u5927\u7AEF"}),createVNode(u,{label:"\u5C0F\u7AEF",value:"\u5C0F\u7AEF"})]),_:1},8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1})):createCommentVNode("",!0),createVNode(l,{label:"\u5730\u5740"},{default:withCtx(()=>[createVNode(a,{modelValue:e.form.addr,"onUpdate:modelValue":o[9]||(o[9]=t=>e.form.addr=t),placeholder:"\u7AEF\u53E3\u53F7"},null,8,["modelValue"])]),_:1}),createVNode(l,{label:"\u5F00\u542FTLS"},{default:withCtx(()=>[createVNode(i,{modelValue:e.form.isTls,"onUpdate:modelValue":o[10]||(o[10]=t=>e.form.isTls=t),class:"ml-4"},{default:withCtx(()=>[createVNode(d,{label:1},{default:withCtx(()=>[_hoisted_2]),_:1}),createVNode(d,{label:0},{default:withCtx(()=>[_hoisted_3]),_:1})]),_:1},8,["modelValue"])]),_:1}),e.form.isTls==1&&e.form.types!="mqtt_server"?(openBlock(),createBlock(l,{key:2,label:"\u9009\u62E9\u8BC1\u4E66"},{default:withCtx(()=>[createVNode(r,{modelValue:e.form.certificateId,"onUpdate:modelValue":o[11]||(o[11]=t=>e.form.certificateId=t),placeholder:"\u8BF7\u9009\u62E9\u8BC1\u4E66"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.certificateList,t=>(openBlock(),createBlock(u,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.form.isTls==1&&e.form.types=="mqtt_server"?(openBlock(),createBlock(l,{key:3,label:"\u63A5\u5165\u65B9\u5F0F"},{default:withCtx(()=>[createVNode(r,{modelValue:e.form.authType,"onUpdate:modelValue":o[12]||(o[12]=t=>e.form.authType=t),placeholder:"\u9009\u62E9\u63A5\u5165\u65B9\u5F0F"},{default:withCtx(()=>[createVNode(u,{label:"Basic",value:1}),createVNode(u,{label:"AccessToken",value:2})]),_:1},8,["modelValue"]),e.form.authType==1?(openBlock(),createBlock(l,{key:0,class:"flex-column",label:"\u7528\u6237\u540D"},{default:withCtx(()=>[createVNode(a,{modelValue:e.form.authUser,"onUpdate:modelValue":o[13]||(o[13]=t=>e.form.authUser=t),placeholder:"\u8BF7\u586B\u5199\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.form.authType==1?(openBlock(),createBlock(l,{key:1,class:"flex-column",label:"\u5BC6\u7801"},{default:withCtx(()=>[createVNode(a,{modelValue:e.form.authPasswd,"onUpdate:modelValue":o[14]||(o[14]=t=>e.form.authPasswd=t),placeholder:"\u8BF7\u586B\u5199\u5BC6\u7801"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.form.authType==2?(openBlock(),createBlock(l,{key:2,class:"flex-column",label:"Aceess Token"},{default:withCtx(()=>[createVNode(a,{modelValue:e.form.accessToken,"onUpdate:modelValue":o[15]||(o[15]=t=>e.form.accessToken=t),placeholder:"\u8BF7\u586B\u5199Aceess Token"},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1})):createCommentVNode("",!0),createVNode(l,{label:"\u542F\u7528"},{default:withCtx(()=>[createVNode(p,{"active-value":1,"inactive-value":0,modelValue:e.form.status,"onUpdate:modelValue":o[16]||(o[16]=t=>e.form.status=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1}),createVNode(s,{title:"\u6CE8\u518C\u5305",name:"2"},{default:withCtx(()=>[createVNode(n,{style:{width:"600px",margin:"0 auto"},model:e.form,"label-width":"98px"},{default:withCtx(()=>[createVNode(l,{label:"\u6B63\u5219\u8868\u8FBE\u5F0F"},{default:withCtx(()=>[createVNode(a,{modelValue:e.form.register.regex,"onUpdate:modelValue":o[17]||(o[17]=t=>e.form.register.regex=t),placeholder:"\u8BF7\u586B\u5199\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),createVNode(s,{title:"\u534F\u8BAE\u9002\u914D",name:"3"},{default:withCtx(()=>[createVNode(n,{style:{width:"600px",margin:"0 auto"},model:e.form,"label-width":"98px"},{default:withCtx(()=>[createVNode(l,{label:"\u534F\u8BAE"},{default:withCtx(()=>[createVNode(r,{modelValue:e.form.protocol.name,"onUpdate:modelValue":o[18]||(o[18]=t=>e.form.protocol.name=t),placeholder:"\u8BF7\u9009\u62E9\u534F\u8BAE\u9002\u914D"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.network_protocols,t=>(openBlock(),createBlock(u,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),createVNode(l,{label:"\u534F\u8BAE\u53C2\u6570"},{default:withCtx(()=>[createVNode(c,{class:"params",ref:"mirrorRef",mode:e.resourceModalPro.mode,content:e.resourceModalPro.content},null,8,["mode","content"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","onTabClick"]),createBaseVNode("div",_hoisted_4,[createVNode(m,{size:"medium"},{default:withCtx(()=>[_hoisted_5]),_:1}),createVNode(m,{onClick:e.submit,size:"medium",type:"primary"},{default:withCtx(()=>[_hoisted_6]),_:1},8,["onClick"])])]),_:1})}var create=_export_sfc(_sfc_main,[["render",_sfc_render],["__scopeId","data-v-50db41e3"]]);export{create as default};
